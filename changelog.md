# 2.1.0

> [!WARNING]
> Данная версия имеет существенные изменения в структуре ответов эндпоинтов. Перед обновлением рекомендуется обновить логику работы в вашем коде, если это возможно, либо как-либо версионировать API - например, с помощью заголовков. Например, при работе с translate.toil.cc будет сделано временное версионирование с помощью заголовка X-FOSWLY-API: "2024-11-27" и X-FOSWLY-API: "Next" (будет использоваться всегда последняя версия API, даже, если она ломает совместимость), при отсутствие, которого будет использоваться старая версия API

- Добавлена валидация конфига
- Добавлена возможность установить все изменяемые значения в конфиге с помощью переменных окружения (.env)
- Добавлены типы для переменных окружения
- Добавлен oxlint и одноименный плагин для eslint
- Добавлена поддержка логирования в Loki
- Добавлена возможность выбрать сервис перевода с помощью установки параметра запроса
- Добавлена возможность массового перевода с помощью POST запроса в котором передается массив с текстовыми фразами
- При возникновении ошибки взаимодействия с провайдером перевода, сервер, теперь, будет выдавать ошибку вида { "error": "..." }
- Возврат пустого языка, теперь, тоже считается за ошибку
- Основная логика сервера вынесена в библиотеку [@toil/translate](https://github.com/FOSWLY/translate)
- Переписана логика логирования
- Плагин cors заменен на выставление корсов через onRequest
- Конфигурация eslint переписана на flat конфиг
- Обновлены все зависимости до последних версий
- Удален плагин sonarjs
- Удалено разделение на fileLog и log в консоль
- Удалена опция для включения логирования всех запросов
- Удалена опция для отключения логирования в файл

# 2.0.0

- Убраны разные варианты документации из-за особенностей библиотеки (оставлен scalar по пути /docs)
- Добавлены GET методы для /translate, /detect (немного быстрее чем POST)
- Убраны настройки отвечающие за ротацию логов (максимальный размер и срок хранения логов)
- Убрана поддержка логирования в hyperdx
- Сервер переписан на Bun с использованием фреймворка Elysia для увеличения производительности

  Причины:

  - Увеличение производительности ([~x1.7 real] 97 Req/s --> 166 Req/s, [~x3.5 local] 5692.49 Req/s --> 19769.18 Req/s)
  - Уменьшение затрат ресурсов (~100mb (спустя некоторое время доходило до ~250mb) --> ~85mb (практически не изменяется со временем), ~10-80% of vCPU --> ~1% of vCPU)

# 1.0.4

- Стандартное оформление документации изменено на Scalar. Другие виды документации, так же, остались доступны с помощью `/redoc` и `/swaggerui`
- Добавлено оформление документации с помощью Scalar

# 1.0.3

- Добавлено логирование случаев, когда Yandex возвращает пустой язык
- Добавлено разделение логов на файлы, если размер файла превышает размер указанный в конфиге. По умолчанию: 10 мб
- Добавлена поддержка сбора логов в hyperdx
- Отключено стандартное логирование строки запроса httpx

# 1.0.2

- Сервер Uvicorn заменен на более производительный Granian (#1)

# 1.0.1

- Сервер Hypercorn заменен на более производительный Uvicorn

# 1.0.0

- Добавлен эндпоинт для перевода
- Добавлен эндпоинт для получения списка языков доступных для перевода
- Добавлен эндпоинт для определения языка по тексту
